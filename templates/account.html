{% extends "base.html" %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç{% endblock %}
{% block link %}
<link rel="stylesheet" href="{{ url_for("static", filename="css/account.css") }}">
<script src="{{ url_for("static", filename="js/account.js") }}"></script>
<script src="{{ url_for("static", filename="js/onboarding.js") }}"></script>
{% endblock %}

{% block body %}
<div class="notification-container" id="notificationContainer">
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
</div>
<div class="account-container">
    <div class="account-header">
        <h2>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
    </div>
    <button class="theme-toggle" id="themeToggle">
        <i class="theme-icon">üåô</i>
    </button>
    <div class="user-info">
        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <strong>{{ current_user.username }}</strong></p>
    </div>
    
    <div class="stats-section statistics">
        <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>–ü—Ä–µ–¥–º–µ—Ç</th>
                    <th>–ü—Ä–∞–≤–∏–ª—å–Ω–æ</th>
                    <th>–û—à–∏–±–∫–∏</th>
                    <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                </tr>
            </thead>
            <tbody>
                {% for stat in stats %}
                <tr>
                    <td>{{ stat.subject }}</td>
                    <td>{{ stat.correct_answers }}</td>
                    <td>{{ stat.wrong_answers }}</td>
                    <td>{{ (stat.correct_answers/(stat.correct_answers+stat.wrong_answers)*100)|round(1) if (stat.correct_answers+stat.wrong_answers) > 0 else 0 }}%</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="account-actions">
        <button id="backBtn" class="back-btn">–ù–∞–∑–∞–¥</button>
        <button id="changePasswordBtn">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
        <button id="logoutBtn">–í—ã–π—Ç–∏</button>
    </div>
    
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h3>
            <form id="changePasswordForm">
                <div class="form-group">
                    <label for="current_password">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="current_password" name="current_password" required>
                    <div class="error-message" id="current_password_error"></div>
                </div>
                
                <div class="form-group">
                    <label for="new_password">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="new_password" name="new_password" required minlength="6">
                    <div class="error-message" id="new_password_error"></div>
                </div>
                
                <div class="form-group">
                    <label for="confirm_password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="confirm_password" name="confirm_password" required>
                    <div class="error-message" id="confirm_password_error"></div>
                </div>
                
                <button type="submit" id="submitPasswordChange">
                    <span id="submitText">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
                    <div id="submitSpinner" class="spinner" style="display: none;"></div>
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
